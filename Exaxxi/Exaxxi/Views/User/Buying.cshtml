@using Microsoft.AspNetCore.Http
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor

<div class="container-fluid" style="background-color:#f2f2f2; min-height:100vh" ng-controller="Buying">
    <div class="row">
        @Html.Partial("~/Views/User/Menu.cshtml")

        <div class="col-md-9">
            <div class="user-info d-flex justify-content-between">
                <div>
                    <i class="far fa-chart-bar fa-fw"></i>PURCHASING<br />
                    <span class="user-number">
                        {{count_buying}}
                    </span>
                </div>
                <div>
                    <i class="fas fa-tag fa-fw"></i>PURCHASING(#)<br />
                    <span class="user-number">
                        20
                    </span>
                </div>
            </div>
            <div class="user-info">
                <ul class="nav nav-tabs user-tab">
                    <li class="nav-item">
                        <a class="nav-link  active" data-toggle="tab" href="#current">Current</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#pending">Pending</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#history">History</a>
                    </li>
                </ul>
                <div class="tab-content">
                    <div id="current" class="container tab-pane active">
                        <table class="table table-hover">
                            <tr>
                                <td>
                                    Item
                                </td>
                                <td class="d-none d-sm-block">
                                    Bid Price
                                </td>
                                <td>
                                    Highest Bid
                                </td>
                                <td>
                                    Lowest Ask
                                </td>
                                <td class="d-none d-sm-block">
                                    Expires
                                </td>
                            </tr>
                            <tr ng-repeat="x in kind_two">
                                <td class="font-weight-bold">
                                    {{x.items.name}}
                                </td>
                                <td class="d-none d-sm-block">
                                    ... VND
                                </td>
                                <td>
                                    {{x.items.highest_bid}} VND
                                </td>
                                <td>
                                    {{x.items.lowest_ask}} VND
                                </td>
                                <td class="d-none d-sm-block">
                                    0
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div id="pending" class="container tab-pane fade">
                        <table class="table table-hover">
                            <tr>
                                <td>
                                    Item
                                </td>
                                <td class="d-none d-sm-block">
                                    Bid Price
                                </td>
                                <td>
                                    Highest Bid
                                </td>
                                <td>
                                    Lowest Ask
                                </td>
                                <td class="d-none d-sm-block">
                                    Expires
                                </td>
                            </tr>
                            <tr ng-repeat="x in kind_one">
                                <td class="font-weight-bold">
                                    {{x.items.name}}
                                </td>
                                <td class="d-none d-sm-block">
                                    ... VND
                                </td>
                                <td>
                                    {{x.items.highest_bid}} VND
                                </td>
                                <td>
                                    {{x.items.lowest_ask}} VND
                                </td>
                                <td class="d-none d-sm-block">
                                    0
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div id="history" class="container tab-pane fade">
                        <table class="table table-hover">
                            <tr>
                                <td>
                                    Item
                                </td>
                                <td class="d-none d-sm-block">
                                    Bid Price
                                </td>
                                <td>
                                    Highest Bid
                                </td>
                                <td>
                                    Lowest Ask
                                </td>
                                <td class="d-none d-sm-block">
                                    Expires
                                </td>
                            </tr>
                            <tr ng-repeat="x in kind_three">
                                <td class="font-weight-bold">
                                    {{x.items.name}}
                                </td>
                                <td class="d-none d-sm-block">
                                    ... VND
                                </td>
                                <td>
                                    {{x.items.highest_bid}} VND
                                </td>
                                <td>
                                    {{x.items.lowest_ask}} VND
                                </td>
                                <td class="d-none d-sm-block">
                                    0
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

@section Scripts{
    <script>
        //Show Department
        exaxxiApp.controller('Buying', function ($scope, $http) {

            //Take Count Buying Of Account
            $http.get("/api/OrdersAPI/CountOrderBuying_Account/" + @HttpContextAccessor.HttpContext.Session.GetInt32("idUser"))
                .then(function (response) { $scope.count_buying = response.data; });

            //Take Detail Buying Of Account with Kind: 1 => current, 2 => pending, 3 => history
            $http.get("/api/OrdersAPI/TakeDetailBuying_Account/1/" + @HttpContextAccessor.HttpContext.Session.GetInt32("idUser"))
                .then(function (response) { $scope.kind_one = response.data; });
            $http.get("/api/OrdersAPI/TakeDetailBuying_Account/2/" + @HttpContextAccessor.HttpContext.Session.GetInt32("idUser"))
                .then(function (response) { $scope.kind_two = response.data; });
            $http.get("/api/OrdersAPI/TakeDetailBuying_Account/3/" + @HttpContextAccessor.HttpContext.Session.GetInt32("idUser"))
                .then(function (response) { $scope.kind_three = response.data; });

        });
    </script>
}